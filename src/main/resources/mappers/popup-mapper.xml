<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="popupMapper">

	<resultMap type="BookWithStock" id="resultBookWithStock">
		<result property="bookId" column="BOOK_ID" />
		<result property="writerId" column="WRITER_ID" />
		<result property="bookName" column="BOOK_NAME" />
		<result property="writerName" column="WRITER_NAME" />
		<result property="bookPriceS" column="BOOK_PRICE_S" />
		<result property="bookPriceR" column="BOOK_PRICE_R" />
		<result property="bookPrice" column="BOOK_PRICE" />
		<result property="category" column="CATEGORY" />
		<result property="isbn" column="ISBN" />
		<result property="bookState" column="BOOK_STATE" />
		<result property="engraving" column="ENGRAVING" />
		<result property="pubDate" column="PUB_DATE" />
		<result property="regDate" column="REG_DATE" />
		<result property="stock" column="CURR_INVEN" />
	</resultMap>
	
	<resultMap type="PrintOffice" id="resultPrintOffice">
		<result property="clientId" column="CLIENT_ID" />
		<result property="category" column="CATEGORY" />
		<result property="clientName" column="CLIENT_NAME" />
		<result property="clientAddress" column="CLIENT_ADDRESS" />
		<result property="clientContact" column="CLIENT_CONTACT" />
		<result property="eid" column="EID" />
		<result property="clientUrl" column="CLIENT_URL" />
		<result property="manager" column="MANAGER" />
		<result property="managerContact" column="MANAGER_CONTACT" />
		<result property="managerEmail" column="MANAGER_EMAIL" />
		<result property="startDate" column="START_DATE" />
		<result property="endDate" column="END_DATE" />
	</resultMap>
	
	<select id="selectBookCountById" parameterType="_int" resultType="_int">
		select count(*) from book
		where book_id = #{ bookId }
	</select>
	
	<select id="selectBookCountByName" parameterType="string" resultType="_int">
		select count(*) from book
		where book_name like '%' || #{ bookName } || '%'
	</select>
	
	<select id="selectBookById" parameterType="_int" resultMap="resultBookWithStock">
		select * from book
		where book_id = #{ bookId }
	</select>
	
	<select id="selectBookByName" parameterType="string" resultMap="resultBookWithStock">
		select *
		from (select rownum rnum, sub.*
			  from (select * from book
			  where book_name like '%' || #{ bookName } || '%'
			  order by book_id desc) sub)
		where rnum between 1 and 10
	</select>
	
	<select id="selectPrintOfficeCountById" parameterType="_int" resultType="_int">
		select count(*) from client
		where category = '인쇄소' and client_id = #{ clientId }
	</select>
	
	<select id="selectPrintOfficeById" parameterType="_int" resultMap="resultPrintOffice">
		select *
		from (select rownum rnum, sub.*
			  from (select * from client
					where category = '인쇄소' and client_id = #{ clientId }) sub)
		where rnum between 1 and 10
	</select>
	
	<select id="selectPrintOfficeCountByName" parameterType="string" resultType="_int">
		select count(*) from client
		where category = '인쇄소' and client_name like '%' || #{ clientName } || '%'
	</select>
	
	<select id="selectPrintOfficeByName" parameterType="string" resultMap="resultPrintOffice">
		select *
		from (select rownum rnum, sub.*
			  from (select * from client
					where category = '인쇄소' and client_name like '%' || #{ clientName } || '%') sub)
		where rnum between 1 and 10
	</select>
	
</mapper>






